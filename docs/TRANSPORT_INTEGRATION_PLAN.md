# 교통 정보 연동 계획

## 개요

Pitch Travel 서비스에 교통 정보 기능을 추가하여 사용자가 여행지까지의 경로를 쉽게 확인할 수 있도록 합니다.

## 1. API 선택

### 1.1 조사 대상

- **네이버 지도 경로 API**
  - 이미 네이버 지도를 사용 중
  - 경로 안내 링크 제공
  - 대중교통/자동차 경로 모두 지원
  - 무료 사용 가능

- **카카오맵 경로 API**
  - 대중교통 경로 제공
  - 자동차 경로 제공
  - 무료 사용 가능

- **대중교통 API (공공데이터포털)**
  - 공공 데이터 활용
  - 무료 사용 가능
  - 단점: API 구조 복잡, 실시간 정보 제한적

- **T맵 API**
  - 실시간 교통 정보 제공
  - 단점: 상업적 사용 시 비용 발생 가능

### 1.2 선택: 네이버 지도 + 카카오맵 링크 방식

**선택 이유**:
- 프로토타입 단계에서 빠른 구현 가능
- 별도의 API 키 불필요
- 사용자가 익숙한 지도 서비스 활용
- 대중교통/자동차 경로 모두 지원

**구현 방식**:
- 네이버 지도 경로 안내 링크 제공
- 카카오맵 경로 안내 링크 제공
- 사용자가 원하는 지도 서비스 선택 가능

**향후 개선**:
- 네이버 지도 Directions API 직접 연동 (API 키 필요)
- 실시간 교통 정보 통합
- 사용자 위치 기반 자동 경로 계산

## 2. 구현 내용

### 2.1 교통 정보 컴포넌트

**파일**: `components/travel-detail/transport-info.tsx`

**주요 기능**:
- 주소 정보 표시 및 복사
- 네이버 지도 경로 안내 링크 (자동차/대중교통)
- 카카오맵 경로 안내 링크 (자동차/대중교통)
- 사용자 위치 기반 경로 안내 (선택 사항)
- 좌표 기반 경로 안내

**UI 구성**:
- 주소 카드
  - 주소 표시
  - 주소 복사 버튼
- 경로 안내 버튼 그리드
  - 네이버 지도 (자동차/대중교통)
  - 카카오맵 (자동차/대중교통)
- 사용자 위치 기반 경로 (선택 사항)
  - 현재 위치 가져오기 버튼
  - 위치 기반 경로 안내 링크

### 2.2 상세페이지 통합

**파일**: `app/travels/[contentId]/page.tsx`

**통합 위치**:
- 우측 사이드바 (날씨 위젯 아래)
- 교통 정보 카드 형태로 표시

**조건부 렌더링**:
- 좌표 정보가 있는 경우에만 표시
- 주소 정보가 있는 경우 주소 표시

## 3. 경로 안내 URL 생성

### 3.1 네이버 지도 경로 안내

**URL 형식**:
```
https://map.naver.com/v5/directions?destination={주소 또는 좌표}&mode={car|public}
```

**파라미터**:
- `destination`: 목적지 주소 또는 좌표
- `mode`: 경로 모드 (`car`: 자동차, `public`: 대중교통)

**사용자 위치 기반 경로**:
```
https://map.naver.com/v5/directions/{출발지_경도},{출발지_위도},,/{목적지_경도},{목적지_위도},,ADDRESS_POI/{목적지_주소}
```

### 3.2 카카오맵 경로 안내

**URL 형식**:
```
https://map.kakao.com/link/to/{이름},{위도},{경도}
https://map.kakao.com/link/to/public/{이름},{위도},{경도}
```

**파라미터**:
- `이름`: 목적지 이름 (URL 인코딩)
- `위도`, `경도`: 목적지 좌표
- `/public/` 경로: 대중교통 경로

## 4. 사용자 위치 기반 경로

### 4.1 Geolocation API 활용

**기능**:
- 브라우저 Geolocation API로 사용자 현재 위치 가져오기
- 사용자 동의 후 위치 정보 사용
- 위치 기반 경로 안내 링크 생성

**주의사항**:
- HTTPS 환경에서만 동작
- 사용자 동의 필요
- 위치 정보 오류 처리

### 4.2 구현 방식

1. "현재 위치로 경로 안내" 버튼 클릭
2. 브라우저 위치 권한 요청
3. 위치 정보 획득 후 경로 안내 링크 생성
4. 네이버 지도에서 경로 표시

## 5. 향후 개선 사항

### 5.1 네이버 지도 Directions API 직접 연동

- 네이버 클라우드 플랫폼(NCP) Directions API 사용
- API 키 발급 필요
- 경로 정보를 직접 가져와서 표시
- 소요 시간, 거리, 경로 상세 정보 제공

### 5.2 실시간 교통 정보

- 실시간 교통 상황 반영
- 소요 시간 동적 업데이트
- 교통 체증 구간 표시

### 5.3 대중교통 상세 정보

- 환승 정보 상세 표시
- 소요 시간 및 비용 계산
- 출발 시간별 경로 조회

### 5.4 경로 비교 기능

- 여러 경로 옵션 비교
- 최단 시간/최단 거리/최소 환승 경로 선택
- 경로별 소요 시간 및 비용 비교

## 6. 테스트 계획

### 6.1 기능 테스트

- [ ] 좌표가 있는 여행지에서 교통 정보 표시 확인
- [ ] 좌표가 없는 여행지에서 위젯이 표시되지 않는지 확인
- [ ] 네이버 지도 경로 안내 링크 동작 확인
- [ ] 카카오맵 경로 안내 링크 동작 확인
- [ ] 주소 복사 기능 확인
- [ ] 사용자 위치 기반 경로 안내 확인

### 6.2 사용자 경험 테스트

- [ ] 모바일에서의 사용성 확인
- [ ] 위치 권한 요청 UX 확인
- [ ] 경로 안내 링크가 새 창에서 열리는지 확인

### 6.3 에러 처리 테스트

- [ ] 위치 권한 거부 시 처리 확인
- [ ] 위치 정보 가져오기 실패 시 처리 확인
- [ ] 좌표 파싱 오류 처리 확인

## 7. 참고 자료

- [네이버 지도 경로 안내](https://map.naver.com/)
- [카카오맵 경로 안내](https://map.kakao.com/)
- [Geolocation API 문서](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API)
- [네이버 클라우드 플랫폼 Directions API](https://www.ncloud.com/product/applicationService/maps)

---

**최종 업데이트**: 2025년 11월
**다음 리뷰**: 사용자 피드백 수집 후

